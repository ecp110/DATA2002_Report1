---
title: "Determining Risk Factors Associate With Red Wine"
subtitle: "DATA2002 Group Presentation"
author: "500520320   480025267   500505430"
output:
  xaringan::moon_reader:
    css: ["default", "assets/sydney-fonts.css", "assets/sydney.css"]
    self_contained: false 
    seal: true 
    nature:
      beforeInit: ["assets/remark-zoom.js", "https://platform.twitter.com/widgets.js"]
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9' 
      navigation:
        scroll: false # disable slide transitions by scrolling
---

```{r load_refs, echo=FALSE, cache=FALSE, message=FALSE}
library(RefManageR)
BibOptions(check.entries = FALSE, 
            bib.style = "authoryear",
            cite.style = 'authoryear', 
            style = "markdown",
            hyperlink = FALSE, 
            dashed = FALSE)

top_icon = function(x) {
  icons::icon_style(
    icons::fontawesome(x),
    position = "fixed", top = 10, right = 10
  )
}
library(tidyverse)
library(GGally)
library(car)
library(ggfortify)
library(sjPlot)
library(equatiomatic)
library(faraway)
library(qtlcharts)
library(caret)
library(kableExtra)
library(janitor)
library(dplyr)
library(leaps)
library(grid)
library(gridExtra)
data = read.table("winequality-red.csv", sep=";", header=T)
dataNew = data.frame(data$quality, data$alcohol, data$volatile.acidity, data$total.sulfur.dioxide, data$citric.acid, data$density)
dataNew = dataNew %>%
  mutate(data.volatile.acidity = log(data.volatile.acidity))
dataNew = dataNew %>%
  mutate(data.total.sulfur.dioxide = log(data.total.sulfur.dioxide))
```



## Introduction 
In this project, we will explore the 'red-wine quality' dataset to research relevance between each factors. The attributes in the dataset are following:
"fixed acidity","volatile acidity","citric acid","residual sugar","chlorides","free sulfur dioxide","total sulfur dioxide","density","pH","sulphates","alcohol","quality"

High quality: (>= 8) Good wine is usually one that has a good balance of sweet, sour, salty, and bitter elements 
Low quality: (< 7.5) Wine that has crossed the line toward vinegar, it can be described as dusty and dried out, all tannin, no fruit.

Linear regression is used to analysis the influence of each attribute on the quality of red wine in our project.

---
## Dataset 

---
<br/><br/><br/><br/><br/><br/><br/><br/>
<div align = center>
# Assumption Checking 

---
## Independence

---
## Linearity
```{r, echo=FALSE, message=FALSE, out.width= "65%", fig.height = 5, out.extra='style="float:right; padding:10px"'}
g1 = data %>%
  ggplot()+
  aes(x=alcohol,y=quality) +
  geom_point(size = 1) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  ggtitle("Red Wine Quality vs Alcohol Percentage")+
  xlab("Alcohol Percentage") +
  ylab("Red Wine Quality") +
  geom_smooth(method='lm', se=FALSE, color='#bc3808') 

g2 = data %>%
  ggplot()+
  aes(x=pH,y=quality) +
  geom_point(size = 1) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  ggtitle("Red Wine Quality vs pH")+
  xlab("Wine pH") +
  ylab("Red Wine Quality") +
  geom_smooth(method='lm', se=FALSE, color='#bc3808') 

grid.arrange(g1, g2, ncol = 2)

```
<br/>
* Linearity refers to the ability to fit a linear relationship between two variables.

* Linearity is essential as we are fitting linear regression models.

* Non-linear data, eg. the pH of the Wine (right diagram) is unable to be accurately modeled with linear regression.

```{r, echo=FALSE, message=FALSE}
nonLinear = data.frame(c("Free Sulfur Dioxide","pH", "Fixed Acidity"))
colnames(nonLinear) = c("Non-Linear Variables")
kable(nonLinear) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


---
## Linearity Transformation
```{r, echo=FALSE, message=FALSE, out.width= "65%", fig.height = 5, out.extra='style="float:right; padding:10px"'}
g1 = data %>%
  ggplot()+
  aes(x=total.sulfur.dioxide,y=quality) +
  geom_point(size = 1) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  xlab("Total Sulfur Dioxide") +
  ylab("Red Wine Quality") +
  geom_smooth(method='lm', se=FALSE, color='#bc3808') 

g2 = dataNew %>%
  ggplot()+
  aes(x=data.total.sulfur.dioxide,y=data.quality) +
  geom_point(size = 1) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  xlab("log(Total Sulfur Dioxide)") +
  ylab("Red Wine Quality") +
  geom_smooth(method='lm', se=FALSE, color='#bc3808') 

grid.arrange(g1, g2, ncol = 2,top=textGrob("Red Wine Quality vs Total Sulfur Dioxide: with & without log"))
```

<br/><br/><br/>
* Transformations on data can be used to better suit the data to regression modelling assumptions.

* An example is the log transformation of Total Sulfur Dioxide.

* Due to it spanning multiple orders of magnitude, the log function allows for a more even and linear distribution, and thus better analysis in the model.

---
## Normality 
```{r, echo=FALSE, message=FALSE, out.width= "65%", fig.height = 5, out.extra='style="float:right; padding:10px"'}
l = lm(quality ~ volatile.acidity, data=data)
g1 = autoplot(l, which=2) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  ggtitle("Q-Q Plot of Volatile Acidity vs Quality")


r = lm(quality ~ residual.sugar, data=data)
g2 = autoplot(r, which=2) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  ggtitle("Q-Q Plot of Residual Sugar vs Quality")

grid.arrange(g1@plots[[1]], g2@plots[[1]], ncol = 2)

```
<br/>
* Normality refers to the how normal the distribution of variable residuals are distributed.

* As our data involved the discrete value of quality, it was often difficult to assess.

* Obvious violations were removed, as can be seen by Residual Sugar.

```{r, echo=FALSE, message=FALSE}
nonLinear = data.frame(c("Residual Sugar"))
colnames(nonLinear) = c("Non-Normal Variables")
kable(nonLinear) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

---
## Homoscedasticity 
```{r, echo=FALSE, message=FALSE, out.width= "65%", fig.height = 5, out.extra='style="float:right; padding:10px"'}
l = lm(quality ~ log(total.sulfur.dioxide), data=data)
g1 = autoplot(l, which=1) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  ggtitle("Residual Plot of Total Sulfur Dioxide")


r = lm(quality ~ chlorides, data=data)
g2 = autoplot(r, which=1) +
  theme_bw() +
  theme(axis.line = element_line(color='black'),
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) +
  ggtitle("Residual Plot of Chlorides")

grid.arrange(g1@plots[[1]], g2@plots[[1]], ncol = 2)

```
<br/>
* Homoscedasticity refers to the even distribution of residual values.

* Residuals should be evenly distributed around the center line (y = 0).

* Residuals should also not 'fan', with a flat and even distribution over the entirety of the fitted values.

```{r, echo=FALSE, message=FALSE}
nonLinear = data.frame(c("Chlorides", "Sulfates"))
colnames(nonLinear) = c("Hetroscedastic Variables")
kable(nonLinear) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


---

## Analysis 
- Selecting appropriate model 
- 
- Forward 
---
## Results
---
## Discussion
---
## Conclusion
#Limitation 
The data collection process was unknown. Therefore, we are uncertain about
- if there are any biases when collecting the data. E.g. selection biases
- the brands of wines 
- whether the same bottle of wine was accidentally been tested multiple times 

Small $r^2$ means the linear model isn't able to represent the total variance well

The wine-quality data doesn't meet most of the linearity assumptions, therefore a nonlinear analysis might be considered 

.red[We should investigate further on how the data was obtained, hence look into if any biases can be removed]
---
## Reference 
.scroll-output[
Wickham et al., (2019). Welcome to the tidyverse. Journal of Open
Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686
  
McLean MW (2017). “RefManageR: Import and Manage BibTeX and BibLaTeX
References in R.” _The Journal of Open Source Software_. doi:
10.21105/joss.00338 (URL: https://doi.org/10.21105/joss.00338).

McLean MW (2014). _Straightforward Bibliography Management in R
Using the RefManager Package_. arXiv: 1403.2036 [cs.DL], <URL:
https://arxiv.org/abs/1403.2036>.

Barret Schloerke, Di Cook, Joseph Larmarange, Francois Briatte,
Moritz Marbach, Edwin Thoen, Amos Elberg and Jason Crowley (2021).
GGally: Extension to 'ggplot2'. R package version 2.1.2.
https://CRAN.R-project.org/package=GGally

John Fox and Sanford Weisberg (2019). An {R} Companion to Applied
Regression, Third Edition. Thousand Oaks CA: Sage. URL:
https://socialsciences.mcmaster.ca/jfox/Books/Companion/

Yuan Tang, Masaaki Horikoshi, and Wenxuan Li. "ggfortify: Unified
Interface to Visualize Statistical Result of Popular R Packages."
The R Journal 8.2 (2016): 478-489.

Lüdecke D (2021). _sjPlot: Data Visualization for Statistics in
Social Science_. R package version 2.8.9, <URL:
https://CRAN.R-project.org/package=sjPlot>.

Daniel Anderson, Andrew Heiss and Jay Sumners (2021).
equatiomatic: Transform Models into 'LaTeX' Equations. R package
version 0.3.0. https://CRAN.R-project.org/package=equatiomatic

Julian Faraway (2016). faraway: Functions and Datasets for Books
by Julian Faraway. R package version 1.0.7.
https://CRAN.R-project.org/package=faraway

Broman KW (2015) R/qtlcharts: interactive graphics for
quantitative trait locus mapping. Genetics 199:359-361
doi:10.1534/genetics.114.172742

Max Kuhn (2021). caret: Classification and Regression Training. R
package version 6.0-90. https://CRAN.R-project.org/package=caret

Hao Zhu (2021). kableExtra: Construct Complex Table with 'kable'
and Pipe Syntax. R package version 1.3.4.
https://CRAN.R-project.org/package=kableExtra

Sam Firke (2021). janitor: Simple Tools for Examining and Cleaning
Dirty Data. R package version 2.1.0.
https://CRAN.R-project.org/package=janitor

Hadley Wickham, Romain François, Lionel Henry and Kirill Müller
(2021). dplyr: A Grammar of Data Manipulation. R package version
1.0.7. https://CRAN.R-project.org/package=dplyr

Thomas Lumley based on Fortran code by Alan Miller (2020). leaps:
Regression Subset Selection. R package version 3.1.
https://CRAN.R-project.org/package=leaps
]